{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Maruti Mane\\\\product_chain_tracker\\\\src\\\\components\\\\TransportDashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { transporterAPI, orderAPI } from \"../services/api\";\nimport \"./TransportDashboard.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TransportDashboard = () => {\n  _s();\n  const transporter = JSON.parse(localStorage.getItem(\"transporter\"));\n  const transporterId = transporter === null || transporter === void 0 ? void 0 : transporter.id;\n  const [orders, setOrders] = useState([]);\n\n  // ---------------------------\n  // Load assigned orders\n  // ---------------------------\n  useEffect(() => {\n    if (transporterId) loadAssignedOrders(transporterId);\n  }, [transporterId]);\n  const loadAssignedOrders = async id => {\n    try {\n      const res = await transporterAPI.getOrdersForTransporter(id);\n      setOrders(res.data || []);\n    } catch (err) {\n      console.error(\"‚ùå Failed to load transporter orders:\", err);\n    }\n  };\n\n  // ---------------------------\n  // Update order status\n  // ---------------------------\n  const updateStatus = async (orderId, status) => {\n    try {\n      console.log(\"Sending status update:\", orderId, status);\n\n      // call backend and get updated DTO (backend returns OrderResponseDTO)\n      const res = await orderAPI.updateTransportStatus(orderId, status);\n      const updatedOrder = res.data;\n\n      // update local UI to match server\n      setOrders(prev => prev.map(o => o.id === orderId ? {\n        ...o,\n        ...updatedOrder\n      } : o));\n      console.log(\"Status updated. Server returned:\", updatedOrder);\n    } catch (err) {\n      console.error(\"‚ùå Failed to update status:\", err);\n      alert(\"Failed to update delivery status\");\n    }\n  };\n  if (!transporterId) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: \"20px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"No transporter logged in!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Set temporary transporter for testing:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n        children: `localStorage.setItem(\"transporter\", JSON.stringify({ id: 2, name: \"Driver X\" }));`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"transport-dashboard\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"\\uD83D\\uDE9A Transporter Dashboard\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: [\"Welcome, \", transporter === null || transporter === void 0 ? void 0 : transporter.name]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), orders.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"No assigned deliveries yet.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"orders-list\",\n      children: orders.map(order => {\n        var _order$status, _order$status2;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"order-card\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\"Order #\", order.id]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Status:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 18\n            }, this), \" \", order.status]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Farmer ID:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 76,\n              columnNumber: 18\n            }, this), \" \", order.farmerId]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Total Amount:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 18\n            }, this), \" \\u20B9\", order.totalAmount]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Vehicle:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 18\n            }, this), \" \", order.vehicleNo || \"-\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Driver:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 18\n            }, this), \" \", order.driverName || \"-\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"actions\",\n            children: [((_order$status = order.status) === null || _order$status === void 0 ? void 0 : _order$status.toUpperCase()) === \"ASSIGNED_TO_TRANSPORTER\" && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"pickup-btn\",\n              onClick: () => updateStatus(order.id, \"OUT_FOR_DELIVERY\"),\n              children: \"\\uD83D\\uDE9A Mark Picked Up\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 19\n            }, this), ((_order$status2 = order.status) === null || _order$status2 === void 0 ? void 0 : _order$status2.toUpperCase()) !== \"DELIVERED\" && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"deliver-btn\",\n              onClick: () => updateStatus(order.id, \"DELIVERED\"),\n              children: \"\\u2714 Mark Delivered\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 15\n          }, this)]\n        }, order.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n};\n_s(TransportDashboard, \"FvMuVccH6DXI6fqfhJiN/VsjZaw=\");\n_c = TransportDashboard;\nexport default TransportDashboard;\nvar _c;\n$RefreshReg$(_c, \"TransportDashboard\");","map":{"version":3,"names":["React","useEffect","useState","transporterAPI","orderAPI","jsxDEV","_jsxDEV","TransportDashboard","_s","transporter","JSON","parse","localStorage","getItem","transporterId","id","orders","setOrders","loadAssignedOrders","res","getOrdersForTransporter","data","err","console","error","updateStatus","orderId","status","log","updateTransportStatus","updatedOrder","prev","map","o","alert","style","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","className","name","length","order","_order$status","_order$status2","farmerId","totalAmount","vehicleNo","driverName","toUpperCase","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Maruti Mane/product_chain_tracker/src/components/TransportDashboard.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { transporterAPI, orderAPI } from \"../services/api\";\nimport \"./TransportDashboard.css\";\n\nconst TransportDashboard = () => {\n  const transporter = JSON.parse(localStorage.getItem(\"transporter\"));\n  const transporterId = transporter?.id;\n\n  const [orders, setOrders] = useState([]);\n\n  // ---------------------------\n  // Load assigned orders\n  // ---------------------------\n  useEffect(() => {\n    if (transporterId) loadAssignedOrders(transporterId);\n  }, [transporterId]);\n\n  const loadAssignedOrders = async (id) => {\n    try {\n      const res = await transporterAPI.getOrdersForTransporter(id);\n      setOrders(res.data || []);\n    } catch (err) {\n      console.error(\"‚ùå Failed to load transporter orders:\", err);\n    }\n  };\n\n  // ---------------------------\n  // Update order status\n  // ---------------------------\n  const updateStatus = async (orderId, status) => {\n    try {\n      console.log(\"Sending status update:\", orderId, status);\n\n      // call backend and get updated DTO (backend returns OrderResponseDTO)\n      const res = await orderAPI.updateTransportStatus(orderId, status);\n      const updatedOrder = res.data;\n\n      // update local UI to match server\n      setOrders((prev) =>\n        prev.map((o) => (o.id === orderId ? { ...o, ...updatedOrder } : o))\n      );\n\n      console.log(\"Status updated. Server returned:\", updatedOrder);\n    } catch (err) {\n      console.error(\"‚ùå Failed to update status:\", err);\n      alert(\"Failed to update delivery status\");\n    }\n  };\n\n  if (!transporterId) {\n    return (\n      <div style={{ padding: \"20px\" }}>\n        <h2>No transporter logged in!</h2>\n        <p>Set temporary transporter for testing:</p>\n        <pre>\n{`localStorage.setItem(\"transporter\", JSON.stringify({ id: 2, name: \"Driver X\" }));`}\n        </pre>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"transport-dashboard\">\n      <h1>üöö Transporter Dashboard</h1>\n      <h3>Welcome, {transporter?.name}</h3>\n\n      {orders.length === 0 ? (\n        <p>No assigned deliveries yet.</p>\n      ) : (\n        <div className=\"orders-list\">\n          {orders.map((order) => (\n            <div className=\"order-card\" key={order.id}>\n              <h3>Order #{order.id}</h3>\n\n              <p><b>Status:</b> {order.status}</p>\n              <p><b>Farmer ID:</b> {order.farmerId}</p>\n              <p><b>Total Amount:</b> ‚Çπ{order.totalAmount}</p>\n\n              <p><b>Vehicle:</b> {order.vehicleNo || \"-\"}</p>\n              <p><b>Driver:</b> {order.driverName || \"-\"}</p>\n\n              <div className=\"actions\">\n                {/* Use case-insensitive check to be fault-tolerant */}\n                {order.status?.toUpperCase() === \"ASSIGNED_TO_TRANSPORTER\" && (\n                  <button\n                    className=\"pickup-btn\"\n                    onClick={() => updateStatus(order.id, \"OUT_FOR_DELIVERY\")}\n                  >\n                    üöö Mark Picked Up\n                  </button>\n                )}\n\n                {order.status?.toUpperCase() !== \"DELIVERED\" && (\n                  <button\n                    className=\"deliver-btn\"\n                    onClick={() => updateStatus(order.id, \"DELIVERED\")}\n                  >\n                    ‚úî Mark Delivered\n                  </button>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TransportDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}