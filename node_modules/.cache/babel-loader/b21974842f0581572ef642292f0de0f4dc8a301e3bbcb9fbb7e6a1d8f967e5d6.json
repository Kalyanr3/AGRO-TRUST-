{"ast":null,"code":"// ==================================================\n// src/services/api.js\n// Centralized API setup for Farmer, Retailer, Transporter, Products, Orders, Cart\n// ==================================================\n\nimport axios from \"axios\";\n\n// ==================================================\n//                    BASE SETUP\n// ==================================================\nconst BASE_URL = \"http://localhost:8080/api\";\nconst api = axios.create({\n  baseURL: BASE_URL,\n  withCredentials: false // âœ… Backend is stateless\n});\n\n// ==================================================\n//                AUTH INTERCEPTOR\n// ==================================================\napi.interceptors.request.use(config => {\n  try {\n    const farmer = JSON.parse(localStorage.getItem(\"farmer\"));\n    const retailer = JSON.parse(localStorage.getItem(\"retailer\"));\n    const transporter = JSON.parse(localStorage.getItem(\"transporter\"));\n    const user = farmer || retailer || transporter;\n\n    // ðŸš« Define which routes are PUBLIC (no Authorization)\n    const isPublic = config.url.includes(\"/transport/\") || config.url.includes(\"/auth/\") || config.url.includes(\"/signup\") || config.url.includes(\"/login\") || config.url.includes(\"/products\") || config.url.includes(\"/farmers\");\n\n    // âœ… Add Basic Auth ONLY for private APIs\n    if (!isPublic && user !== null && user !== void 0 && user.email && user !== null && user !== void 0 && user.password) {\n      const token = btoa(`${user.email}:${user.password}`);\n      config.headers.Authorization = `Basic ${token}`;\n    } else {\n      delete config.headers.Authorization;\n    }\n  } catch (err) {\n    console.warn(\"âš ï¸ Axios Interceptor Error:\", err);\n  }\n  return config;\n});\n\n// ==================================================\n//                    AUTH APIS\n// ==================================================\n\n// ðŸ‘¨â€ðŸŒ¾ Farmer Authentication\nexport const authAPI = {\n  farmerSignup: data => api.post(\"/auth/farmer/register\", data),\n  farmerLogin: data => api.post(\"/auth/farmer/login\", data)\n};\n\n// ðŸ›ï¸ Retailer Authentication\nexport const retailerAuthAPI = {\n  signup: data => api.post(\"/retailer/auth/signup\", data),\n  login: data => api.post(\"/retailer/auth/login\", data)\n};\n\n// ðŸšš Transporter Authentication\nexport const transporterAuthAPI = {\n  signup: data => api.post(\"/transporters/signup\", data),\n  login: data => api.post(\"/transporters/login\", data)\n};\n\n// ==================================================\n//                    FARMER APIS\n// ==================================================\nexport const farmerAPI = {\n  getAllFarmers: () => api.get(\"/farmers\"),\n  getFarmerById: id => api.get(`/farmers/${id}`)\n};\n\n// ==================================================\n//                    PRODUCT APIS\n// ==================================================\nexport const productAPI = {\n  addProduct: formData => api.post(\"/products/add\", formData, {\n    headers: {\n      \"Content-Type\": \"multipart/form-data\"\n    }\n  }),\n  getMyProducts: () => api.get(\"/products/my\"),\n  getFarmerProducts: farmerId => api.get(`/products/farmer/${farmerId}`),\n  getAllProducts: () => api.get(\"/products\")\n};\n\n// ==================================================\n//                    RETAILER APIS\n// ==================================================\nexport const retailerAPI = {\n  getAllFarmersWithProducts: () => api.get(\"/farmers/with-products\"),\n  getFarmerById: farmerId => api.get(`/farmers/${farmerId}`)\n};\n\n// ==================================================\n//                    CART APIS\n// ==================================================\nexport const cartAPI = {\n  addToCart: (retailerId, productId, quantity) => api.post(\"/cart/add\", {\n    retailerId,\n    productId,\n    quantity\n  }, {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  }),\n  getCart: retailerId => api.get(`/cart/${retailerId}`),\n  updateQuantity: (itemId, payload) => api.put(`/cart/update/${itemId}`, payload, {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  }),\n  removeItem: itemId => api.delete(`/cart/remove/${itemId}`),\n  clearCart: retailerId => api.delete(`/cart/clear/${retailerId}`)\n};\n\n// ==================================================\n//                    ORDER APIS\n// ==================================================\nexport const orderAPI = {\n  placeOrder: (retailerId, paymentMethod = \"Online\") => api.post(`/orders/place/${retailerId}?paymentMethod=${paymentMethod}`),\n  getOrders: retailerId => api.get(`/orders/${retailerId}`),\n  getOrderDetails: orderId => api.get(`/orders/details/${orderId}`)\n};\n\n// ==================================================\n//                    TRANSPORT APIS\n// ==================================================\n//\n// âœ… Retailer assigns transport\n// âœ… Transporter views assigned deliveries\n// âœ… Transporter updates delivery status\n//\nexport const transportAPI = {\n  // When retailer assigns transport to an order\n  assignTransport: (orderId, data) => api.post(`/transport/assign/${orderId}`, data),\n  // When transporter fetches their assigned deliveries\n  getOrders: async transporterId => {\n    try {\n      const res = await api.get(`/transport/orders/${transporterId}`);\n      return res;\n    } catch (err) {\n      console.error(\"ðŸš¨ Backend fetch failed:\", err);\n      throw err;\n    }\n  },\n  // When transporter updates delivery status\n  updateStatus: (orderId, status) => api.put(`/transport/${orderId}/status?status=${status}`)\n};\n\n// ==================================================\n//                    DEFAULT EXPORT\n// ==================================================\nexport default api;","map":{"version":3,"names":["axios","BASE_URL","api","create","baseURL","withCredentials","interceptors","request","use","config","farmer","JSON","parse","localStorage","getItem","retailer","transporter","user","isPublic","url","includes","email","password","token","btoa","headers","Authorization","err","console","warn","authAPI","farmerSignup","data","post","farmerLogin","retailerAuthAPI","signup","login","transporterAuthAPI","farmerAPI","getAllFarmers","get","getFarmerById","id","productAPI","addProduct","formData","getMyProducts","getFarmerProducts","farmerId","getAllProducts","retailerAPI","getAllFarmersWithProducts","cartAPI","addToCart","retailerId","productId","quantity","getCart","updateQuantity","itemId","payload","put","removeItem","delete","clearCart","orderAPI","placeOrder","paymentMethod","getOrders","getOrderDetails","orderId","transportAPI","assignTransport","transporterId","res","error","updateStatus","status"],"sources":["C:/Users/Maruti Mane/product_chain_tracker/src/services/api.js"],"sourcesContent":["// ==================================================\n// src/services/api.js\n// Centralized API setup for Farmer, Retailer, Transporter, Products, Orders, Cart\n// ==================================================\n\nimport axios from \"axios\";\n\n// ==================================================\n//                    BASE SETUP\n// ==================================================\nconst BASE_URL = \"http://localhost:8080/api\";\n\nconst api = axios.create({\n  baseURL: BASE_URL,\n  withCredentials: false, // âœ… Backend is stateless\n});\n\n// ==================================================\n//                AUTH INTERCEPTOR\n// ==================================================\napi.interceptors.request.use((config) => {\n  try {\n    const farmer = JSON.parse(localStorage.getItem(\"farmer\"));\n    const retailer = JSON.parse(localStorage.getItem(\"retailer\"));\n    const transporter = JSON.parse(localStorage.getItem(\"transporter\"));\n    const user = farmer || retailer || transporter;\n\n    // ðŸš« Define which routes are PUBLIC (no Authorization)\n    const isPublic =\n      config.url.includes(\"/transport/\") ||\n      config.url.includes(\"/auth/\") ||\n      config.url.includes(\"/signup\") ||\n      config.url.includes(\"/login\") ||\n      config.url.includes(\"/products\") ||\n      config.url.includes(\"/farmers\");\n\n    // âœ… Add Basic Auth ONLY for private APIs\n    if (!isPublic && user?.email && user?.password) {\n      const token = btoa(`${user.email}:${user.password}`);\n      config.headers.Authorization = `Basic ${token}`;\n    } else {\n      delete config.headers.Authorization;\n    }\n  } catch (err) {\n    console.warn(\"âš ï¸ Axios Interceptor Error:\", err);\n  }\n  return config;\n});\n\n// ==================================================\n//                    AUTH APIS\n// ==================================================\n\n// ðŸ‘¨â€ðŸŒ¾ Farmer Authentication\nexport const authAPI = {\n  farmerSignup: (data) => api.post(\"/auth/farmer/register\", data),\n  farmerLogin: (data) => api.post(\"/auth/farmer/login\", data),\n};\n\n// ðŸ›ï¸ Retailer Authentication\nexport const retailerAuthAPI = {\n  signup: (data) => api.post(\"/retailer/auth/signup\", data),\n  login: (data) => api.post(\"/retailer/auth/login\", data),\n};\n\n// ðŸšš Transporter Authentication\nexport const transporterAuthAPI = {\n  signup: (data) => api.post(\"/transporters/signup\", data),\n  login: (data) => api.post(\"/transporters/login\", data),\n};\n\n// ==================================================\n//                    FARMER APIS\n// ==================================================\nexport const farmerAPI = {\n  getAllFarmers: () => api.get(\"/farmers\"),\n  getFarmerById: (id) => api.get(`/farmers/${id}`),\n};\n\n// ==================================================\n//                    PRODUCT APIS\n// ==================================================\nexport const productAPI = {\n  addProduct: (formData) =>\n    api.post(\"/products/add\", formData, {\n      headers: { \"Content-Type\": \"multipart/form-data\" },\n    }),\n\n  getMyProducts: () => api.get(\"/products/my\"),\n  getFarmerProducts: (farmerId) => api.get(`/products/farmer/${farmerId}`),\n  getAllProducts: () => api.get(\"/products\"),\n};\n\n// ==================================================\n//                    RETAILER APIS\n// ==================================================\nexport const retailerAPI = {\n  getAllFarmersWithProducts: () => api.get(\"/farmers/with-products\"),\n  getFarmerById: (farmerId) => api.get(`/farmers/${farmerId}`),\n};\n\n// ==================================================\n//                    CART APIS\n// ==================================================\nexport const cartAPI = {\n  addToCart: (retailerId, productId, quantity) =>\n    api.post(\n      \"/cart/add\",\n      { retailerId, productId, quantity },\n      { headers: { \"Content-Type\": \"application/json\" } }\n    ),\n\n  getCart: (retailerId) => api.get(`/cart/${retailerId}`),\n  updateQuantity: (itemId, payload) =>\n    api.put(`/cart/update/${itemId}`, payload, {\n      headers: { \"Content-Type\": \"application/json\" },\n    }),\n  removeItem: (itemId) => api.delete(`/cart/remove/${itemId}`),\n  clearCart: (retailerId) => api.delete(`/cart/clear/${retailerId}`),\n};\n\n// ==================================================\n//                    ORDER APIS\n// ==================================================\nexport const orderAPI = {\n  placeOrder: (retailerId, paymentMethod = \"Online\") =>\n    api.post(`/orders/place/${retailerId}?paymentMethod=${paymentMethod}`),\n\n  getOrders: (retailerId) => api.get(`/orders/${retailerId}`),\n\n  getOrderDetails: (orderId) => api.get(`/orders/details/${orderId}`),\n};\n\n// ==================================================\n//                    TRANSPORT APIS\n// ==================================================\n//\n// âœ… Retailer assigns transport\n// âœ… Transporter views assigned deliveries\n// âœ… Transporter updates delivery status\n//\nexport const transportAPI = {\n  // When retailer assigns transport to an order\n  assignTransport: (orderId, data) =>\n    api.post(`/transport/assign/${orderId}`, data),\n\n  // When transporter fetches their assigned deliveries\n  getOrders: async (transporterId) => {\n    try {\n      const res = await api.get(`/transport/orders/${transporterId}`);\n      return res;\n    } catch (err) {\n      console.error(\"ðŸš¨ Backend fetch failed:\", err);\n      throw err;\n    }\n  },\n\n  // When transporter updates delivery status\n  updateStatus: (orderId, status) =>\n    api.put(`/transport/${orderId}/status?status=${status}`),\n};\n\n// ==================================================\n//                    DEFAULT EXPORT\n// ==================================================\nexport default api;\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA,OAAOA,KAAK,MAAM,OAAO;;AAEzB;AACA;AACA;AACA,MAAMC,QAAQ,GAAG,2BAA2B;AAE5C,MAAMC,GAAG,GAAGF,KAAK,CAACG,MAAM,CAAC;EACvBC,OAAO,EAAEH,QAAQ;EACjBI,eAAe,EAAE,KAAK,CAAE;AAC1B,CAAC,CAAC;;AAEF;AACA;AACA;AACAH,GAAG,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,IAAK;EACvC,IAAI;IACF,MAAMC,MAAM,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC,CAAC;IACzD,MAAMC,QAAQ,GAAGJ,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,CAAC;IAC7D,MAAME,WAAW,GAAGL,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC,CAAC;IACnE,MAAMG,IAAI,GAAGP,MAAM,IAAIK,QAAQ,IAAIC,WAAW;;IAE9C;IACA,MAAME,QAAQ,GACZT,MAAM,CAACU,GAAG,CAACC,QAAQ,CAAC,aAAa,CAAC,IAClCX,MAAM,CAACU,GAAG,CAACC,QAAQ,CAAC,QAAQ,CAAC,IAC7BX,MAAM,CAACU,GAAG,CAACC,QAAQ,CAAC,SAAS,CAAC,IAC9BX,MAAM,CAACU,GAAG,CAACC,QAAQ,CAAC,QAAQ,CAAC,IAC7BX,MAAM,CAACU,GAAG,CAACC,QAAQ,CAAC,WAAW,CAAC,IAChCX,MAAM,CAACU,GAAG,CAACC,QAAQ,CAAC,UAAU,CAAC;;IAEjC;IACA,IAAI,CAACF,QAAQ,IAAID,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEI,KAAK,IAAIJ,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEK,QAAQ,EAAE;MAC9C,MAAMC,KAAK,GAAGC,IAAI,CAAC,GAAGP,IAAI,CAACI,KAAK,IAAIJ,IAAI,CAACK,QAAQ,EAAE,CAAC;MACpDb,MAAM,CAACgB,OAAO,CAACC,aAAa,GAAG,SAASH,KAAK,EAAE;IACjD,CAAC,MAAM;MACL,OAAOd,MAAM,CAACgB,OAAO,CAACC,aAAa;IACrC;EACF,CAAC,CAAC,OAAOC,GAAG,EAAE;IACZC,OAAO,CAACC,IAAI,CAAC,6BAA6B,EAAEF,GAAG,CAAC;EAClD;EACA,OAAOlB,MAAM;AACf,CAAC,CAAC;;AAEF;AACA;AACA;;AAEA;AACA,OAAO,MAAMqB,OAAO,GAAG;EACrBC,YAAY,EAAGC,IAAI,IAAK9B,GAAG,CAAC+B,IAAI,CAAC,uBAAuB,EAAED,IAAI,CAAC;EAC/DE,WAAW,EAAGF,IAAI,IAAK9B,GAAG,CAAC+B,IAAI,CAAC,oBAAoB,EAAED,IAAI;AAC5D,CAAC;;AAED;AACA,OAAO,MAAMG,eAAe,GAAG;EAC7BC,MAAM,EAAGJ,IAAI,IAAK9B,GAAG,CAAC+B,IAAI,CAAC,uBAAuB,EAAED,IAAI,CAAC;EACzDK,KAAK,EAAGL,IAAI,IAAK9B,GAAG,CAAC+B,IAAI,CAAC,sBAAsB,EAAED,IAAI;AACxD,CAAC;;AAED;AACA,OAAO,MAAMM,kBAAkB,GAAG;EAChCF,MAAM,EAAGJ,IAAI,IAAK9B,GAAG,CAAC+B,IAAI,CAAC,sBAAsB,EAAED,IAAI,CAAC;EACxDK,KAAK,EAAGL,IAAI,IAAK9B,GAAG,CAAC+B,IAAI,CAAC,qBAAqB,EAAED,IAAI;AACvD,CAAC;;AAED;AACA;AACA;AACA,OAAO,MAAMO,SAAS,GAAG;EACvBC,aAAa,EAAEA,CAAA,KAAMtC,GAAG,CAACuC,GAAG,CAAC,UAAU,CAAC;EACxCC,aAAa,EAAGC,EAAE,IAAKzC,GAAG,CAACuC,GAAG,CAAC,YAAYE,EAAE,EAAE;AACjD,CAAC;;AAED;AACA;AACA;AACA,OAAO,MAAMC,UAAU,GAAG;EACxBC,UAAU,EAAGC,QAAQ,IACnB5C,GAAG,CAAC+B,IAAI,CAAC,eAAe,EAAEa,QAAQ,EAAE;IAClCrB,OAAO,EAAE;MAAE,cAAc,EAAE;IAAsB;EACnD,CAAC,CAAC;EAEJsB,aAAa,EAAEA,CAAA,KAAM7C,GAAG,CAACuC,GAAG,CAAC,cAAc,CAAC;EAC5CO,iBAAiB,EAAGC,QAAQ,IAAK/C,GAAG,CAACuC,GAAG,CAAC,oBAAoBQ,QAAQ,EAAE,CAAC;EACxEC,cAAc,EAAEA,CAAA,KAAMhD,GAAG,CAACuC,GAAG,CAAC,WAAW;AAC3C,CAAC;;AAED;AACA;AACA;AACA,OAAO,MAAMU,WAAW,GAAG;EACzBC,yBAAyB,EAAEA,CAAA,KAAMlD,GAAG,CAACuC,GAAG,CAAC,wBAAwB,CAAC;EAClEC,aAAa,EAAGO,QAAQ,IAAK/C,GAAG,CAACuC,GAAG,CAAC,YAAYQ,QAAQ,EAAE;AAC7D,CAAC;;AAED;AACA;AACA;AACA,OAAO,MAAMI,OAAO,GAAG;EACrBC,SAAS,EAAEA,CAACC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,KACzCvD,GAAG,CAAC+B,IAAI,CACN,WAAW,EACX;IAAEsB,UAAU;IAAEC,SAAS;IAAEC;EAAS,CAAC,EACnC;IAAEhC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB;EAAE,CACpD,CAAC;EAEHiC,OAAO,EAAGH,UAAU,IAAKrD,GAAG,CAACuC,GAAG,CAAC,SAASc,UAAU,EAAE,CAAC;EACvDI,cAAc,EAAEA,CAACC,MAAM,EAAEC,OAAO,KAC9B3D,GAAG,CAAC4D,GAAG,CAAC,gBAAgBF,MAAM,EAAE,EAAEC,OAAO,EAAE;IACzCpC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAmB;EAChD,CAAC,CAAC;EACJsC,UAAU,EAAGH,MAAM,IAAK1D,GAAG,CAAC8D,MAAM,CAAC,gBAAgBJ,MAAM,EAAE,CAAC;EAC5DK,SAAS,EAAGV,UAAU,IAAKrD,GAAG,CAAC8D,MAAM,CAAC,eAAeT,UAAU,EAAE;AACnE,CAAC;;AAED;AACA;AACA;AACA,OAAO,MAAMW,QAAQ,GAAG;EACtBC,UAAU,EAAEA,CAACZ,UAAU,EAAEa,aAAa,GAAG,QAAQ,KAC/ClE,GAAG,CAAC+B,IAAI,CAAC,iBAAiBsB,UAAU,kBAAkBa,aAAa,EAAE,CAAC;EAExEC,SAAS,EAAGd,UAAU,IAAKrD,GAAG,CAACuC,GAAG,CAAC,WAAWc,UAAU,EAAE,CAAC;EAE3De,eAAe,EAAGC,OAAO,IAAKrE,GAAG,CAACuC,GAAG,CAAC,mBAAmB8B,OAAO,EAAE;AACpE,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMC,YAAY,GAAG;EAC1B;EACAC,eAAe,EAAEA,CAACF,OAAO,EAAEvC,IAAI,KAC7B9B,GAAG,CAAC+B,IAAI,CAAC,qBAAqBsC,OAAO,EAAE,EAAEvC,IAAI,CAAC;EAEhD;EACAqC,SAAS,EAAE,MAAOK,aAAa,IAAK;IAClC,IAAI;MACF,MAAMC,GAAG,GAAG,MAAMzE,GAAG,CAACuC,GAAG,CAAC,qBAAqBiC,aAAa,EAAE,CAAC;MAC/D,OAAOC,GAAG;IACZ,CAAC,CAAC,OAAOhD,GAAG,EAAE;MACZC,OAAO,CAACgD,KAAK,CAAC,0BAA0B,EAAEjD,GAAG,CAAC;MAC9C,MAAMA,GAAG;IACX;EACF,CAAC;EAED;EACAkD,YAAY,EAAEA,CAACN,OAAO,EAAEO,MAAM,KAC5B5E,GAAG,CAAC4D,GAAG,CAAC,cAAcS,OAAO,kBAAkBO,MAAM,EAAE;AAC3D,CAAC;;AAED;AACA;AACA;AACA,eAAe5E,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}